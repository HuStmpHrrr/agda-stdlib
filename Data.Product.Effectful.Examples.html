<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Product.Effectful.Examples</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Universe-sensitive functor and monad instances for the Product type.</a>
<a id="178" class="Comment">------------------------------------------------------------------------</a>

<a id="252" class="Symbol">{-#</a> <a id="256" class="Keyword">OPTIONS</a> <a id="264" class="Pragma">--without-K</a> <a id="276" class="Pragma">--safe</a> <a id="283" class="Symbol">#-}</a>

<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Algebra.html" class="Module">Algebra</a>

<a id="309" class="Keyword">module</a> <a id="316" href="Data.Product.Effectful.Examples.html" class="Module">Data.Product.Effectful.Examples</a>
  <a id="350" class="Symbol">{</a><a id="351" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="353" href="Data.Product.Effectful.Examples.html#353" class="Bound">e</a> <a id="355" href="Data.Product.Effectful.Examples.html#355" class="Bound">b</a><a id="356" class="Symbol">}</a> <a id="358" class="Symbol">{</a><a id="359" href="Data.Product.Effectful.Examples.html#359" class="Bound">A</a> <a id="361" class="Symbol">:</a> <a id="363" href="Algebra.Bundles.html#4419" class="Record">Monoid</a> <a id="370" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="372" href="Data.Product.Effectful.Examples.html#353" class="Bound">e</a><a id="373" class="Symbol">}</a> <a id="375" class="Symbol">{</a><a id="376" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a> <a id="378" class="Symbol">:</a> <a id="380" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="384" href="Data.Product.Effectful.Examples.html#355" class="Bound">b</a><a id="385" class="Symbol">}</a> <a id="387" class="Keyword">where</a>

<a id="394" class="Keyword">open</a> <a id="399" class="Keyword">import</a> <a id="406" href="Level.html" class="Module">Level</a> <a id="412" class="Keyword">using</a> <a id="418" class="Symbol">(</a><a id="419" href="Level.html#400" class="Record">Lift</a><a id="423" class="Symbol">;</a> <a id="425" href="Level.html#457" class="InductiveConstructor">lift</a><a id="429" class="Symbol">;</a> <a id="431" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a><a id="434" class="Symbol">)</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Effect.Functor.html" class="Module">Effect.Functor</a> <a id="463" class="Keyword">using</a> <a id="469" class="Symbol">(</a><a id="470" href="Effect.Functor.html#497" class="Record">RawFunctor</a><a id="480" class="Symbol">)</a>
<a id="482" class="Keyword">open</a> <a id="487" class="Keyword">import</a> <a id="494" href="Effect.Monad.html" class="Module">Effect.Monad</a> <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Effect.Monad.html#444" class="Function">RawMonad</a><a id="522" class="Symbol">)</a>
<a id="524" class="Keyword">open</a> <a id="529" class="Keyword">import</a> <a id="536" href="Data.Product.html" class="Module">Data.Product</a>
<a id="549" class="Keyword">open</a> <a id="554" class="Keyword">import</a> <a id="561" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html" class="Module">Data.Product.Relation.Binary.Pointwise.NonDependent</a>
<a id="613" class="Keyword">open</a> <a id="618" class="Keyword">import</a> <a id="625" href="Function.html" class="Module">Function</a>
<a id="634" class="Keyword">import</a> <a id="641" href="Function.Identity.Effectful.html" class="Module">Function.Identity.Effectful</a> <a id="669" class="Symbol">as</a> <a id="672" class="Module">Id</a>
<a id="675" class="Keyword">open</a> <a id="680" class="Keyword">import</a> <a id="687" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="703" class="Keyword">using</a> <a id="709" class="Symbol">(</a><a id="710" href="Relation.Binary.Core.html#882" class="Function">Rel</a><a id="713" class="Symbol">)</a>
<a id="715" class="Keyword">open</a> <a id="720" class="Keyword">import</a> <a id="727" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="765" class="Keyword">using</a> <a id="771" class="Symbol">(</a><a id="772" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="775" class="Symbol">;</a> <a id="777" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="781" class="Symbol">)</a>

<a id="784" class="Comment">------------------------------------------------------------------------</a>
<a id="857" class="Comment">-- Examples</a>

<a id="870" class="Comment">-- Note that these examples are simple unit tests, because the type</a>
<a id="938" class="Comment">-- checker verifies them.</a>

<a id="965" class="Keyword">private</a>

  <a id="976" class="Keyword">module</a> <a id="A"></a><a id="983" href="Data.Product.Effectful.Examples.html#983" class="Module">A</a> <a id="985" class="Symbol">=</a> <a id="987" href="Algebra.Bundles.html#4419" class="Module">Monoid</a> <a id="994" href="Data.Product.Effectful.Examples.html#359" class="Bound">A</a>

  <a id="999" class="Keyword">open</a> <a id="1004" class="Keyword">import</a> <a id="1011" href="Data.Product.Effectful.Left.html" class="Module">Data.Product.Effectful.Left</a> <a id="1039" href="Algebra.Bundles.html#4812" class="Function">A.rawMonoid</a> <a id="1051" href="Data.Product.Effectful.Examples.html#355" class="Bound">b</a>

  <a id="_≈_"></a><a id="1056" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">_≈_</a> <a id="1060" class="Symbol">:</a> <a id="1062" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1066" class="Symbol">(</a><a id="1067" href="Algebra.Bundles.html#4498" class="Function">A.Carrier</a> <a id="1077" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1079" href="Level.html#400" class="Record">Lift</a> <a id="1084" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1086" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1087" class="Symbol">)</a> <a id="1089" class="Symbol">(</a><a id="1090" href="Data.Product.Effectful.Examples.html#353" class="Bound">e</a> <a id="1092" href="Agda.Primitive.html#810" class="Primitive Operator">⊔</a> <a id="1094" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1096" href="Agda.Primitive.html#810" class="Primitive Operator">⊔</a> <a id="1098" href="Data.Product.Effectful.Examples.html#355" class="Bound">b</a><a id="1099" class="Symbol">)</a>
  <a id="1103" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">_≈_</a> <a id="1107" class="Symbol">=</a> <a id="1109" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html#1343" class="Function">Pointwise</a> <a id="1119" href="Algebra.Bundles.html#4519" class="Function Operator">A._≈_</a> <a id="1125" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>

  <a id="1132" class="Keyword">open</a> <a id="1137" href="Effect.Functor.html#497" class="Module">RawFunctor</a> <a id="1148" href="Data.Product.Effectful.Left.Base.html#948" class="Function">functor</a>

  <a id="1159" class="Comment">-- This type to the right of × needs to be a &quot;lifted&quot; version of (B : Set b)</a>
  <a id="1238" class="Comment">-- that lives in the universe (Set (a ⊔ b)).</a>
  <a id="fmapIdₗ"></a><a id="1285" href="Data.Product.Effectful.Examples.html#1285" class="Function">fmapIdₗ</a> <a id="1293" class="Symbol">:</a> <a id="1295" class="Symbol">(</a><a id="1296" href="Data.Product.Effectful.Examples.html#1296" class="Bound">x</a> <a id="1298" class="Symbol">:</a> <a id="1300" href="Algebra.Bundles.html#4498" class="Function">A.Carrier</a> <a id="1310" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1312" href="Level.html#400" class="Record">Lift</a> <a id="1317" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1319" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1320" class="Symbol">)</a> <a id="1322" class="Symbol">→</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Function.Base.html#695" class="Function">id</a> <a id="1328" href="Effect.Functor.html#606" class="Function Operator">&lt;$&gt;</a> <a id="1332" href="Data.Product.Effectful.Examples.html#1296" class="Bound">x</a><a id="1333" class="Symbol">)</a> <a id="1335" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">≈</a> <a id="1337" href="Data.Product.Effectful.Examples.html#1296" class="Bound">x</a>
  <a id="1341" href="Data.Product.Effectful.Examples.html#1285" class="Function">fmapIdₗ</a> <a id="1349" href="Data.Product.Effectful.Examples.html#1349" class="Bound">x</a> <a id="1351" class="Symbol">=</a> <a id="1353" href="Relation.Binary.Structures.html#1568" class="Function">A.refl</a> <a id="1360" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1362" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="1370" class="Keyword">open</a> <a id="1375" href="Effect.Monad.html#828" class="Module">RawMonad</a> <a id="1384" href="Data.Product.Effectful.Left.html#1525" class="Function">monad</a>

  <a id="1393" class="Comment">-- Now, let&#39;s show that &quot;return&quot; is a unit for &gt;&gt;=. We use Lift in exactly</a>
  <a id="1470" class="Comment">-- the same way as above. The data (x : B) then needs to be &quot;lifted&quot; to</a>
  <a id="1544" class="Comment">-- this new type (Lift B).</a>
  <a id="returnUnitL"></a><a id="1573" href="Data.Product.Effectful.Examples.html#1573" class="Function">returnUnitL</a> <a id="1585" class="Symbol">:</a> <a id="1587" class="Symbol">∀</a> <a id="1589" class="Symbol">{</a><a id="1590" href="Data.Product.Effectful.Examples.html#1590" class="Bound">x</a> <a id="1592" class="Symbol">:</a> <a id="1594" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1595" class="Symbol">}</a> <a id="1597" class="Symbol">{</a><a id="1598" href="Data.Product.Effectful.Examples.html#1598" class="Bound">f</a> <a id="1600" class="Symbol">:</a> <a id="1602" href="Level.html#400" class="Record">Lift</a> <a id="1607" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1609" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a> <a id="1611" class="Symbol">→</a> <a id="1613" href="Algebra.Bundles.html#4498" class="Function">A.Carrier</a> <a id="1623" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1625" href="Level.html#400" class="Record">Lift</a> <a id="1630" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1632" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1633" class="Symbol">}</a> <a id="1635" class="Symbol">→</a>
                <a id="1653" class="Symbol">((</a><a id="1655" href="Effect.Monad.Indexed.html#640" class="Function">return</a> <a id="1662" class="Symbol">(</a><a id="1663" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="1668" href="Data.Product.Effectful.Examples.html#1590" class="Bound">x</a><a id="1669" class="Symbol">))</a> <a id="1672" href="Effect.Monad.Indexed.html#673" class="Function Operator">&gt;&gt;=</a> <a id="1676" href="Data.Product.Effectful.Examples.html#1598" class="Bound">f</a><a id="1677" class="Symbol">)</a> <a id="1679" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">≈</a> <a id="1681" href="Data.Product.Effectful.Examples.html#1598" class="Bound">f</a> <a id="1683" class="Symbol">(</a><a id="1684" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="1689" href="Data.Product.Effectful.Examples.html#1590" class="Bound">x</a><a id="1690" class="Symbol">)</a>
  <a id="1694" href="Data.Product.Effectful.Examples.html#1573" class="Function">returnUnitL</a> <a id="1706" class="Symbol">=</a> <a id="1708" href="Algebra.Structures.html#3023" class="Function">A.identityˡ</a> <a id="1720" class="Symbol">_</a> <a id="1722" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1724" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="returnUnitR"></a><a id="1732" href="Data.Product.Effectful.Examples.html#1732" class="Function">returnUnitR</a> <a id="1744" class="Symbol">:</a> <a id="1746" class="Symbol">{</a><a id="1747" href="Data.Product.Effectful.Examples.html#1747" class="Bound">x</a> <a id="1749" class="Symbol">:</a> <a id="1751" href="Algebra.Bundles.html#4498" class="Function">A.Carrier</a> <a id="1761" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1763" href="Level.html#400" class="Record">Lift</a> <a id="1768" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1770" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1771" class="Symbol">}</a> <a id="1773" class="Symbol">→</a> <a id="1775" class="Symbol">(</a><a id="1776" href="Data.Product.Effectful.Examples.html#1747" class="Bound">x</a> <a id="1778" href="Effect.Monad.Indexed.html#673" class="Function Operator">&gt;&gt;=</a> <a id="1782" href="Effect.Monad.Indexed.html#640" class="Function">return</a><a id="1788" class="Symbol">)</a> <a id="1790" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">≈</a> <a id="1792" href="Data.Product.Effectful.Examples.html#1747" class="Bound">x</a>
  <a id="1796" href="Data.Product.Effectful.Examples.html#1732" class="Function">returnUnitR</a> <a id="1808" class="Symbol">=</a> <a id="1810" href="Algebra.Structures.html#3084" class="Function">A.identityʳ</a> <a id="1822" class="Symbol">_</a> <a id="1824" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1826" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="1834" class="Comment">-- And another (limited version of a) monad law...</a>
  <a id="bindCompose"></a><a id="1887" href="Data.Product.Effectful.Examples.html#1887" class="Function">bindCompose</a> <a id="1899" class="Symbol">:</a> <a id="1901" class="Symbol">∀</a> <a id="1903" class="Symbol">{</a><a id="1904" href="Data.Product.Effectful.Examples.html#1904" class="Bound">f</a> <a id="1906" href="Data.Product.Effectful.Examples.html#1906" class="Bound">g</a> <a id="1908" class="Symbol">:</a> <a id="1910" href="Level.html#400" class="Record">Lift</a> <a id="1915" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1917" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a> <a id="1919" class="Symbol">→</a> <a id="1921" href="Algebra.Bundles.html#4498" class="Function">A.Carrier</a> <a id="1931" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1933" href="Level.html#400" class="Record">Lift</a> <a id="1938" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1940" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1941" class="Symbol">}</a> <a id="1943" class="Symbol">→</a>
                <a id="1961" class="Symbol">{</a><a id="1962" href="Data.Product.Effectful.Examples.html#1962" class="Bound">x</a> <a id="1964" class="Symbol">:</a> <a id="1966" href="Algebra.Bundles.html#4498" class="Function">A.Carrier</a> <a id="1976" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1978" href="Level.html#400" class="Record">Lift</a> <a id="1983" href="Data.Product.Effectful.Examples.html#351" class="Bound">a</a> <a id="1985" href="Data.Product.Effectful.Examples.html#376" class="Bound">B</a><a id="1986" class="Symbol">}</a> <a id="1988" class="Symbol">→</a>
                <a id="2006" class="Symbol">((</a><a id="2008" href="Data.Product.Effectful.Examples.html#1962" class="Bound">x</a> <a id="2010" href="Effect.Monad.Indexed.html#673" class="Function Operator">&gt;&gt;=</a> <a id="2014" href="Data.Product.Effectful.Examples.html#1904" class="Bound">f</a><a id="2015" class="Symbol">)</a> <a id="2017" href="Effect.Monad.Indexed.html#673" class="Function Operator">&gt;&gt;=</a> <a id="2021" href="Data.Product.Effectful.Examples.html#1906" class="Bound">g</a><a id="2022" class="Symbol">)</a> <a id="2024" href="Data.Product.Effectful.Examples.html#1056" class="Function Operator">≈</a> <a id="2026" class="Symbol">(</a><a id="2027" href="Data.Product.Effectful.Examples.html#1962" class="Bound">x</a> <a id="2029" href="Effect.Monad.Indexed.html#673" class="Function Operator">&gt;&gt;=</a> <a id="2033" class="Symbol">(λ</a> <a id="2036" href="Data.Product.Effectful.Examples.html#2036" class="Bound">y</a> <a id="2038" class="Symbol">→</a> <a id="2040" class="Symbol">(</a><a id="2041" href="Data.Product.Effectful.Examples.html#1904" class="Bound">f</a> <a id="2043" href="Data.Product.Effectful.Examples.html#2036" class="Bound">y</a> <a id="2045" href="Effect.Monad.Indexed.html#673" class="Function Operator">&gt;&gt;=</a> <a id="2049" href="Data.Product.Effectful.Examples.html#1906" class="Bound">g</a><a id="2050" class="Symbol">)))</a>
  <a id="2056" href="Data.Product.Effectful.Examples.html#1887" class="Function">bindCompose</a> <a id="2068" class="Symbol">=</a> <a id="2070" href="Algebra.Structures.html#1864" class="Function">A.assoc</a> <a id="2078" class="Symbol">_</a> <a id="2080" class="Symbol">_</a> <a id="2082" class="Symbol">_</a> <a id="2084" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2086" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>