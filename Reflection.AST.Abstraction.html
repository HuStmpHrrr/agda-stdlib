<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.AST.Abstraction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Abstractions used in the reflection machinery</a>
<a id="155" class="Comment">------------------------------------------------------------------------</a>

<a id="229" class="Symbol">{-#</a> <a id="233" class="Keyword">OPTIONS</a> <a id="241" class="Pragma">--without-K</a> <a id="253" class="Pragma">--safe</a> <a id="260" class="Symbol">#-}</a>

<a id="265" class="Keyword">module</a> <a id="272" href="Reflection.AST.Abstraction.html" class="Module">Reflection.AST.Abstraction</a> <a id="299" class="Keyword">where</a>

<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="333" class="Symbol">as</a> <a id="336" class="Module">List</a> <a id="341" class="Keyword">using</a> <a id="347" class="Symbol">(</a><a id="348" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="352" class="Symbol">)</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Data.Product.html" class="Module">Data.Product</a> <a id="379" class="Keyword">using</a> <a id="385" class="Symbol">(</a><a id="386" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="389" class="Symbol">;</a> <a id="391" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="394" class="Symbol">;</a> <a id="396" href="Data.Product.html#3422" class="Function">uncurry</a><a id="403" class="Symbol">;</a> <a id="405" href="Data.Product.html#2313" class="Function Operator">&lt;_,_&gt;</a><a id="410" class="Symbol">)</a>
<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Data.String.html" class="Module">Data.String</a> <a id="436" class="Symbol">as</a> <a id="439" class="Module">String</a> <a id="446" class="Keyword">using</a> <a id="452" class="Symbol">(</a><a id="453" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="459" class="Symbol">)</a>
<a id="461" class="Keyword">open</a> <a id="466" class="Keyword">import</a> <a id="473" href="Level.html" class="Module">Level</a>
<a id="479" class="Keyword">open</a> <a id="484" class="Keyword">import</a> <a id="491" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="508" class="Keyword">import</a> <a id="515" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="542" class="Symbol">as</a> <a id="545" class="Module">Dec</a>
<a id="549" class="Keyword">open</a> <a id="554" class="Keyword">import</a> <a id="561" href="Relation.Nullary.Product.html" class="Module">Relation.Nullary.Product</a> <a id="586" class="Keyword">using</a> <a id="592" class="Symbol">(</a><a id="593" href="Relation.Nullary.Product.html#921" class="Function Operator">_×-dec_</a><a id="600" class="Symbol">)</a>
<a id="602" class="Keyword">open</a> <a id="607" class="Keyword">import</a> <a id="614" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="630" class="Keyword">open</a> <a id="635" class="Keyword">import</a> <a id="642" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="681" class="Keyword">private</a>
  <a id="691" class="Keyword">variable</a>
    <a id="704" href="Reflection.AST.Abstraction.html#704" class="Generalizable">a</a> <a id="706" href="Reflection.AST.Abstraction.html#706" class="Generalizable">b</a> <a id="708" class="Symbol">:</a> <a id="710" href="Agda.Primitive.html#597" class="Postulate">Level</a>
    <a id="720" href="Reflection.AST.Abstraction.html#720" class="Generalizable">A</a> <a id="722" href="Reflection.AST.Abstraction.html#722" class="Generalizable">B</a> <a id="724" class="Symbol">:</a> <a id="726" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="730" href="Reflection.AST.Abstraction.html#704" class="Generalizable">a</a>
    <a id="736" href="Reflection.AST.Abstraction.html#736" class="Generalizable">s</a> <a id="738" href="Reflection.AST.Abstraction.html#738" class="Generalizable">t</a> <a id="740" class="Symbol">:</a> <a id="742" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
    <a id="753" href="Reflection.AST.Abstraction.html#753" class="Generalizable">x</a> <a id="755" href="Reflection.AST.Abstraction.html#755" class="Generalizable">y</a> <a id="757" class="Symbol">:</a> <a id="759" href="Reflection.AST.Abstraction.html#720" class="Generalizable">A</a>

<a id="762" class="Comment">------------------------------------------------------------------------</a>
<a id="835" class="Comment">-- Re-exporting the builtins publicly</a>

<a id="874" class="Keyword">open</a> <a id="879" class="Keyword">import</a> <a id="886" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="910" class="Keyword">public</a>
  <a id="919" class="Keyword">using</a> <a id="925" class="Symbol">(</a><a id="926" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a><a id="929" class="Symbol">)</a>

<a id="932" class="Keyword">open</a> <a id="937" href="Agda.Builtin.Reflection.html#3944" class="Module">Abs</a> <a id="941" class="Keyword">public</a>

<a id="949" class="Comment">------------------------------------------------------------------------</a>
<a id="1022" class="Comment">-- Operations</a>

<a id="map"></a><a id="1037" href="Reflection.AST.Abstraction.html#1037" class="Function">map</a> <a id="1041" class="Symbol">:</a> <a id="1043" class="Symbol">(</a><a id="1044" href="Reflection.AST.Abstraction.html#720" class="Generalizable">A</a> <a id="1046" class="Symbol">→</a> <a id="1048" href="Reflection.AST.Abstraction.html#722" class="Generalizable">B</a><a id="1049" class="Symbol">)</a> <a id="1051" class="Symbol">→</a> <a id="1053" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1057" href="Reflection.AST.Abstraction.html#720" class="Generalizable">A</a> <a id="1059" class="Symbol">→</a> <a id="1061" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1065" href="Reflection.AST.Abstraction.html#722" class="Generalizable">B</a>
<a id="1067" href="Reflection.AST.Abstraction.html#1037" class="Function">map</a> <a id="1071" href="Reflection.AST.Abstraction.html#1071" class="Bound">f</a> <a id="1073" class="Symbol">(</a><a id="1074" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1078" href="Reflection.AST.Abstraction.html#1078" class="Bound">s</a> <a id="1080" href="Reflection.AST.Abstraction.html#1080" class="Bound">x</a><a id="1081" class="Symbol">)</a> <a id="1083" class="Symbol">=</a> <a id="1085" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1089" href="Reflection.AST.Abstraction.html#1078" class="Bound">s</a> <a id="1091" class="Symbol">(</a><a id="1092" href="Reflection.AST.Abstraction.html#1071" class="Bound">f</a> <a id="1094" href="Reflection.AST.Abstraction.html#1080" class="Bound">x</a><a id="1095" class="Symbol">)</a>

<a id="1098" class="Comment">------------------------------------------------------------------------</a>
<a id="1171" class="Comment">-- Decidable equality</a>

<a id="abs-injective₁"></a><a id="1194" href="Reflection.AST.Abstraction.html#1194" class="Function">abs-injective₁</a> <a id="1209" class="Symbol">:</a> <a id="1211" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1215" href="Reflection.AST.Abstraction.html#736" class="Generalizable">s</a> <a id="1217" href="Reflection.AST.Abstraction.html#753" class="Generalizable">x</a> <a id="1219" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1221" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1225" href="Reflection.AST.Abstraction.html#738" class="Generalizable">t</a> <a id="1227" href="Reflection.AST.Abstraction.html#755" class="Generalizable">y</a> <a id="1229" class="Symbol">→</a> <a id="1231" href="Reflection.AST.Abstraction.html#736" class="Generalizable">s</a> <a id="1233" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1235" href="Reflection.AST.Abstraction.html#738" class="Generalizable">t</a>
<a id="1237" href="Reflection.AST.Abstraction.html#1194" class="Function">abs-injective₁</a> <a id="1252" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1257" class="Symbol">=</a> <a id="1259" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="abs-injective₂"></a><a id="1265" href="Reflection.AST.Abstraction.html#1265" class="Function">abs-injective₂</a> <a id="1280" class="Symbol">:</a> <a id="1282" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1286" href="Reflection.AST.Abstraction.html#736" class="Generalizable">s</a> <a id="1288" href="Reflection.AST.Abstraction.html#753" class="Generalizable">x</a> <a id="1290" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1292" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1296" href="Reflection.AST.Abstraction.html#738" class="Generalizable">t</a> <a id="1298" href="Reflection.AST.Abstraction.html#755" class="Generalizable">y</a> <a id="1300" class="Symbol">→</a> <a id="1302" href="Reflection.AST.Abstraction.html#753" class="Generalizable">x</a> <a id="1304" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1306" href="Reflection.AST.Abstraction.html#755" class="Generalizable">y</a>
<a id="1308" href="Reflection.AST.Abstraction.html#1265" class="Function">abs-injective₂</a> <a id="1323" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1328" class="Symbol">=</a> <a id="1330" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="abs-injective"></a><a id="1336" href="Reflection.AST.Abstraction.html#1336" class="Function">abs-injective</a> <a id="1350" class="Symbol">:</a> <a id="1352" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1356" href="Reflection.AST.Abstraction.html#736" class="Generalizable">s</a> <a id="1358" href="Reflection.AST.Abstraction.html#753" class="Generalizable">x</a> <a id="1360" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1362" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1366" href="Reflection.AST.Abstraction.html#738" class="Generalizable">t</a> <a id="1368" href="Reflection.AST.Abstraction.html#755" class="Generalizable">y</a> <a id="1370" class="Symbol">→</a> <a id="1372" href="Reflection.AST.Abstraction.html#736" class="Generalizable">s</a> <a id="1374" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1376" href="Reflection.AST.Abstraction.html#738" class="Generalizable">t</a> <a id="1378" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1380" href="Reflection.AST.Abstraction.html#753" class="Generalizable">x</a> <a id="1382" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1384" href="Reflection.AST.Abstraction.html#755" class="Generalizable">y</a>
<a id="1386" href="Reflection.AST.Abstraction.html#1336" class="Function">abs-injective</a> <a id="1400" class="Symbol">=</a> <a id="1402" href="Data.Product.html#2313" class="Function Operator">&lt;</a> <a id="1404" href="Reflection.AST.Abstraction.html#1194" class="Function">abs-injective₁</a> <a id="1419" href="Data.Product.html#2313" class="Function Operator">,</a> <a id="1421" href="Reflection.AST.Abstraction.html#1265" class="Function">abs-injective₂</a> <a id="1436" href="Data.Product.html#2313" class="Function Operator">&gt;</a>

<a id="1439" class="Comment">-- We often need decidability of equality for Abs A when implementing it</a>
<a id="1512" class="Comment">-- for A. Unfortunately ≡-dec makes the termination checker unhappy.</a>
<a id="1581" class="Comment">-- Instead, we can match on both Abs A and use unAbs-dec for an obviously</a>
<a id="1655" class="Comment">-- decreasing recursive call.</a>

<a id="unAbs"></a><a id="1686" href="Reflection.AST.Abstraction.html#1686" class="Function">unAbs</a> <a id="1692" class="Symbol">:</a> <a id="1694" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1698" href="Reflection.AST.Abstraction.html#720" class="Generalizable">A</a> <a id="1700" class="Symbol">→</a> <a id="1702" href="Reflection.AST.Abstraction.html#720" class="Generalizable">A</a>
<a id="1704" href="Reflection.AST.Abstraction.html#1686" class="Function">unAbs</a> <a id="1710" class="Symbol">(</a><a id="1711" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1715" href="Reflection.AST.Abstraction.html#1715" class="Bound">s</a> <a id="1717" href="Reflection.AST.Abstraction.html#1717" class="Bound">a</a><a id="1718" class="Symbol">)</a> <a id="1720" class="Symbol">=</a> <a id="1722" href="Reflection.AST.Abstraction.html#1717" class="Bound">a</a>

<a id="unAbs-dec"></a><a id="1725" href="Reflection.AST.Abstraction.html#1725" class="Function">unAbs-dec</a> <a id="1735" class="Symbol">:</a> <a id="1737" class="Symbol">{</a><a id="1738" href="Reflection.AST.Abstraction.html#1738" class="Bound">abs1</a> <a id="1743" href="Reflection.AST.Abstraction.html#1743" class="Bound">abs2</a> <a id="1748" class="Symbol">:</a> <a id="1750" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1754" href="Reflection.AST.Abstraction.html#720" class="Generalizable">A</a><a id="1755" class="Symbol">}</a> <a id="1757" class="Symbol">→</a> <a id="1759" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="1763" class="Symbol">(</a><a id="1764" href="Reflection.AST.Abstraction.html#1686" class="Function">unAbs</a> <a id="1770" href="Reflection.AST.Abstraction.html#1738" class="Bound">abs1</a> <a id="1775" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1777" href="Reflection.AST.Abstraction.html#1686" class="Function">unAbs</a> <a id="1783" href="Reflection.AST.Abstraction.html#1743" class="Bound">abs2</a><a id="1787" class="Symbol">)</a> <a id="1789" class="Symbol">→</a> <a id="1791" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="1795" class="Symbol">(</a><a id="1796" href="Reflection.AST.Abstraction.html#1738" class="Bound">abs1</a> <a id="1801" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1803" href="Reflection.AST.Abstraction.html#1743" class="Bound">abs2</a><a id="1807" class="Symbol">)</a>
<a id="1809" href="Reflection.AST.Abstraction.html#1725" class="Function">unAbs-dec</a> <a id="1819" class="Symbol">{</a><a id="1820" class="Argument">abs1</a> <a id="1825" class="Symbol">=</a> <a id="1827" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1831" href="Reflection.AST.Abstraction.html#1831" class="Bound">s</a> <a id="1833" href="Reflection.AST.Abstraction.html#1833" class="Bound">a</a><a id="1834" class="Symbol">}</a> <a id="1836" class="Symbol">{</a><a id="1837" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1841" href="Reflection.AST.Abstraction.html#1841" class="Bound">t</a> <a id="1843" href="Reflection.AST.Abstraction.html#1843" class="Bound">a′</a><a id="1845" class="Symbol">}</a> <a id="1847" href="Reflection.AST.Abstraction.html#1847" class="Bound">a≟a′</a> <a id="1852" class="Symbol">=</a>
  <a id="1856" href="Relation.Nullary.Decidable.Core.html#3621" class="Function">Dec.map′</a> <a id="1865" class="Symbol">(</a><a id="1866" href="Data.Product.html#3422" class="Function">uncurry</a> <a id="1874" class="Symbol">(</a><a id="1875" href="Relation.Binary.PropositionalEquality.Core.html#1367" class="Function">cong₂</a> <a id="1881" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a><a id="1884" class="Symbol">))</a> <a id="1887" href="Reflection.AST.Abstraction.html#1336" class="Function">abs-injective</a> <a id="1901" class="Symbol">(</a><a id="1902" href="Reflection.AST.Abstraction.html#1831" class="Bound">s</a> <a id="1904" href="Data.String.Properties.html#2275" class="Function Operator">String.≟</a> <a id="1913" href="Reflection.AST.Abstraction.html#1841" class="Bound">t</a> <a id="1915" href="Relation.Nullary.Product.html#921" class="Function Operator">×-dec</a> <a id="1921" href="Reflection.AST.Abstraction.html#1847" class="Bound">a≟a′</a><a id="1925" class="Symbol">)</a>

<a id="≡-dec"></a><a id="1928" href="Reflection.AST.Abstraction.html#1928" class="Function">≡-dec</a> <a id="1934" class="Symbol">:</a> <a id="1936" href="Relation.Binary.Definitions.html#6143" class="Function">DecidableEquality</a> <a id="1954" href="Reflection.AST.Abstraction.html#720" class="Generalizable">A</a> <a id="1956" class="Symbol">→</a> <a id="1958" href="Relation.Binary.Definitions.html#6143" class="Function">DecidableEquality</a> <a id="1976" class="Symbol">(</a><a id="1977" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1981" href="Reflection.AST.Abstraction.html#720" class="Generalizable">A</a><a id="1982" class="Symbol">)</a>
<a id="1984" href="Reflection.AST.Abstraction.html#1928" class="Function">≡-dec</a> <a id="1990" href="Reflection.AST.Abstraction.html#1990" class="Bound Operator">_≟_</a> <a id="1994" href="Reflection.AST.Abstraction.html#1994" class="Bound">x</a> <a id="1996" href="Reflection.AST.Abstraction.html#1996" class="Bound">y</a> <a id="1998" class="Symbol">=</a> <a id="2000" href="Reflection.AST.Abstraction.html#1725" class="Function">unAbs-dec</a> <a id="2010" class="Symbol">(</a><a id="2011" href="Reflection.AST.Abstraction.html#1686" class="Function">unAbs</a> <a id="2017" href="Reflection.AST.Abstraction.html#1994" class="Bound">x</a> <a id="2019" href="Reflection.AST.Abstraction.html#1990" class="Bound Operator">≟</a> <a id="2021" href="Reflection.AST.Abstraction.html#1686" class="Function">unAbs</a> <a id="2027" href="Reflection.AST.Abstraction.html#1996" class="Bound">y</a><a id="2028" class="Symbol">)</a>
</pre></body></html>